<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Votre Entreprise - Syst√®me de Comptabilit√©</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- √âcran de connexion -->
    <div id="ecran-login" class="ecran-login" style="display: none;">
        <div class="login-card">
            <div class="login-header">
                <h1>Votre Entreprise</h1>
                <p>Syst√®me de comptabilit√©</p>
            </div>

            <!-- Formulaire de connexion -->
            <div id="form-connexion">
                <h2>Connexion</h2>
                <form onsubmit="App.soumettreConnexion(event)">
                    <div class="form-group">
                        <label for="login-email">Courriel</label>
                        <input type="email" id="login-email" required placeholder="exemple@courriel.com">
                    </div>
                    <div class="form-group">
                        <label for="login-mdp">Mot de passe</label>
                        <input type="password" id="login-mdp" required placeholder="Mot de passe" minlength="6">
                    </div>
                    <div id="login-erreur" class="alert alert-danger" style="display: none;"></div>
                    <button type="submit" class="btn btn-primary btn-login" id="btn-connexion">Se connecter</button>
                </form>
                <p class="login-mdp-oublie"><a href="#" onclick="App.reinitialiserMotDePasse(); return false;">Mot de passe oubli√©?</a></p>
                <p class="login-toggle">Pas de compte? <a href="#" onclick="App.afficherPrix(); return false;">Cr√©er un compte</a></p>
            </div>

            <!-- Formulaire d'inscription -->
            <div id="form-inscription" style="display: none;">
                <h2>Cr√©er un compte</h2>
                <form onsubmit="App.soumettreInscription(event)">
                    <div class="form-group">
                        <label for="inscription-email">Courriel</label>
                        <input type="email" id="inscription-email" required placeholder="exemple@courriel.com">
                    </div>
                    <div class="form-group">
                        <label for="inscription-mdp">Mot de passe</label>
                        <input type="password" id="inscription-mdp" required placeholder="Minimum 6 caract√®res" minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="inscription-mdp-confirm">Confirmer le mot de passe</label>
                        <input type="password" id="inscription-mdp-confirm" required placeholder="Confirmer le mot de passe" minlength="6">
                    </div>
                    <div id="inscription-erreur" class="alert alert-danger" style="display: none;"></div>
                    <button type="submit" class="btn btn-primary btn-login" id="btn-inscription">Cr√©er le compte</button>
                </form>
                <p class="login-toggle">D√©j√† un compte? <a href="#" onclick="App.basculerInscription(false); return false;">Se connecter</a></p>
            </div>

            <!-- √âcran de prix -->
            <div id="ecran-prix" style="display: none;">
                <div class="prix-contenu">
                    <h2>Abonnement</h2>
                    <div class="prix-card">
                        <div class="prix-montant">9,95 $<span class="prix-periode">/mois</span></div>
                        <ul class="prix-features">
                            <li>Comptabilit√© compl√®te</li>
                            <li>Gestion multi-dossiers</li>
                            <li>Rapports financiers</li>
                            <li>Facturation clients et fournisseurs</li>
                        </ul>
                        <button class="btn btn-primary btn-login" onclick="App.basculerInscription(true)">Essai gratuit 14 jours</button>
                    </div>
                    <p class="login-toggle"><a href="#" onclick="App.basculerInscription(false); return false;">Retour √† la connexion</a></p>
                </div>
            </div>

            <!-- √âcran abonnement requis (essai expir√©) -->
            <div id="ecran-abonnement-requis" style="display: none;">
                <div class="abonnement-requis-contenu">
                    <h2>Votre essai est termin√©</h2>
                    <p class="abonnement-requis-msg">Votre p√©riode d'essai gratuit de 14 jours est termin√©e.</p>
                    <div class="prix-card">
                        <div class="prix-montant">9,95 $<span class="prix-periode">/mois</span></div>
                        <p class="abonnement-requis-info">Pour continuer √† utiliser le logiciel, veuillez vous abonner.</p>
                    </div>
                    <button class="btn btn-secondary btn-login" onclick="App.deconnecter()">D√©connexion</button>
                </div>
            </div>
        </div>
    </div>

    <!-- √âcran de s√©lection de dossier -->
    <div id="ecran-dossiers" class="ecran-dossiers">
        <div class="dossiers-header">
            <h1>Votre Entreprise</h1>
            <p>Syst√®me de comptabilit√©</p>
        </div>
        <div class="dossiers-actions">
            <button class="btn btn-primary" onclick="App.afficherCreationDossier()">+ Nouveau dossier</button>
            <button class="btn btn-secondary" onclick="App.deconnecter()" style="margin-left: 10px;">D√©connexion</button>
        </div>
        <div id="dossiers-liste" class="dossiers-container">
            <!-- Liste des dossiers g√©n√©r√©e dynamiquement -->
        </div>
    </div>

    <!-- Application principale (hidden par d√©faut) -->
    <div id="app-principal" style="display: none;">
        <!-- Barre de menu -->
        <nav class="menu-bar">
            <div class="menu-item">
                <span class="menu-title">Fichier</span>
                <div class="menu-dropdown">
                    <button onclick="App.afficherCreationDossier()">Nouveau dossier</button>
                    <button onclick="App.changerDossier()">Changer de dossier</button>
                    <hr>
                    <button onclick="App.exporter()">Exporter (JSON)</button>
                    <button onclick="App.importer()">Importer</button>
                    <hr>
                    <button onclick="App.confirmerSuppressionDossier()">Supprimer ce dossier</button>
                    <hr>
                    <button onclick="App.deconnecter()">D√©connexion</button>
                </div>
            </div>
            <div class="menu-item">
                <span class="menu-title">Rapports</span>
                <div class="menu-dropdown">
                    <button onclick="Rapports.afficherBilan()">Bilan</button>
                    <button onclick="Rapports.afficherEtatResultats()">√âtat des r√©sultats</button>
                    <button onclick="Rapports.afficherBalance()">Balance de v√©rification</button>
                    <button onclick="Rapports.afficherGrandLivre()">Grand livre</button>
                    <hr>
                    <button onclick="Rapports.afficherAgeComptesClients()">√Çge des comptes clients</button>
                    <button onclick="Rapports.afficherAgeComptesFournisseurs()">√Çge des comptes fournisseurs</button>
                    <hr>
                    <button onclick="Rapports.afficherRentabiliteProjet()">Rentabilit√© par projet</button>
                </div>
            </div>
            <div class="menu-item">
                <span class="menu-title">Outils</span>
                <div class="menu-dropdown">
                    <button onclick="App.calculatrice()">Calculatrice</button>
                    <button onclick="App.fermetureExercice()">Fermeture d'exercice</button>
                </div>
            </div>
            <div class="menu-item">
                <span class="menu-title">Aide</span>
                <div class="menu-dropdown">
                    <button onclick="App.aPropos()">√Ä propos</button>
                </div>
            </div>
            <div class="menu-spacer"></div>
            <div class="menu-info">
                <span id="entreprise-nom">Votre Entreprise</span>
                <span id="utilisateur-email" class="menu-email"></span>
            </div>
        </nav>

        <!-- Contenu principal -->
        <main class="main-content">
            <!-- √âcran d'accueil avec les 6 modules -->
            <div id="accueil" class="page active">
                <h1>Tableau de Bord</h1>
                <div class="modules-grid">
                    <button class="module-btn" onclick="General.afficher()">
                        <span class="module-icon">üìä</span>
                        <span class="module-name">Module G√©n√©ral</span>
                        <span class="module-desc">Grand livre, journal, √©critures</span>
                    </button>
                    <button class="module-btn" onclick="Achats.afficher()">
                        <span class="module-icon">üì•</span>
                        <span class="module-name">Achats</span>
                        <span class="module-desc">Factures fournisseurs</span>
                    </button>
                    <button class="module-btn" onclick="Ventes.afficher()">
                        <span class="module-icon">üì§</span>
                        <span class="module-name">Ventes</span>
                        <span class="module-desc">Factures clients</span>
                    </button>
                    <button class="module-btn" onclick="Parametres.afficher()">
                        <span class="module-icon">‚öôÔ∏è</span>
                        <span class="module-name">Param√®tres</span>
                        <span class="module-desc">Plan comptable, taxes, config</span>
                    </button>
                    <button class="module-btn" onclick="Paiements.afficher()">
                        <span class="module-icon">üí≥</span>
                        <span class="module-name">Paiements</span>
                        <span class="module-desc">Paiements fournisseurs</span>
                    </button>
                    <button class="module-btn" onclick="Encaissements.afficher()">
                        <span class="module-icon">üí∞</span>
                        <span class="module-name">Encaissements</span>
                        <span class="module-desc">R√©ception paiements clients</span>
                    </button>
                    <button class="module-btn" onclick="Immobilisations.afficher()">
                        <span class="module-icon">üèóÔ∏è</span>
                        <span class="module-name">Immobilisations</span>
                        <span class="module-desc">Amortissement des actifs</span>
                    </button>
                </div>

                <!-- R√©sum√© rapide -->
                <div class="dashboard-summary">
                    <div class="summary-card">
                        <h3>Encaisse</h3>
                        <p class="amount" id="dash-encaisse">0,00 $</p>
                    </div>
                    <div class="summary-card">
                        <h3>Comptes clients</h3>
                        <p class="amount" id="dash-clients">0,00 $</p>
                    </div>
                    <div class="summary-card">
                        <h3>Comptes fournisseurs</h3>
                        <p class="amount" id="dash-fournisseurs">0,00 $</p>
                    </div>
                    <div class="summary-card">
                        <h3>Revenus du mois</h3>
                        <p class="amount" id="dash-revenus">0,00 $</p>
                    </div>
                </div>
            </div>

            <!-- Pages des modules (g√©n√©r√©es dynamiquement) -->
            <div id="module-general" class="page"></div>
            <div id="module-parametres" class="page"></div>
            <div id="module-achats" class="page"></div>
            <div id="module-paiements" class="page"></div>
            <div id="module-encaissements" class="page"></div>
            <div id="module-ventes" class="page"></div>
            <div id="module-rapports" class="page"></div>
            <div id="module-immobilisations" class="page"></div>
        </main>
    </div>

    <!-- Modal g√©n√©rique (hors des deux conteneurs) -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-titre"></h2>
                <button class="modal-close" onclick="App.fermerModal()">&times;</button>
            </div>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Calculatrice (hors des deux conteneurs) -->
    <div id="calculatrice" class="calculatrice hidden">
        <div class="calc-header">
            <span>Calculatrice</span>
            <button onclick="App.fermerCalculatrice()">&times;</button>
        </div>
        <input type="text" id="calc-display" readonly>
        <div class="calc-buttons">
            <button onclick="App.calcBtn('7')">7</button>
            <button onclick="App.calcBtn('8')">8</button>
            <button onclick="App.calcBtn('9')">9</button>
            <button onclick="App.calcBtn('/')">/</button>
            <button onclick="App.calcBtn('4')">4</button>
            <button onclick="App.calcBtn('5')">5</button>
            <button onclick="App.calcBtn('6')">6</button>
            <button onclick="App.calcBtn('*')">*</button>
            <button onclick="App.calcBtn('1')">1</button>
            <button onclick="App.calcBtn('2')">2</button>
            <button onclick="App.calcBtn('3')">3</button>
            <button onclick="App.calcBtn('-')">-</button>
            <button onclick="App.calcBtn('0')">0</button>
            <button onclick="App.calcBtn('.')">.</button>
            <button onclick="App.calcEgal()">=</button>
            <button onclick="App.calcBtn('+')">+</button>
            <button onclick="App.calcClear()" class="calc-clear">C</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

    <!-- jsPDF pour g√©n√©ration de factures PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.4/jspdf.plugin.autotable.min.js"></script>

    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/models/compte.js"></script>
    <script src="js/models/transaction.js"></script>
    <script src="js/models/client.js"></script>
    <script src="js/models/fournisseur.js"></script>
    <script src="js/models/facture.js"></script>
    <script src="js/models/projet.js"></script>
    <script src="js/models/immobilisation.js"></script>
    <script src="js/modules/parametres.js"></script>
    <script src="js/modules/general.js"></script>
    <script src="js/modules/ventes.js"></script>
    <script src="js/modules/encaissements.js"></script>
    <script src="js/modules/achats.js"></script>
    <script src="js/modules/paiements.js"></script>
    <script src="js/modules/rapports.js"></script>
    <script src="js/modules/pdf-facture.js"></script>
    <script src="js/modules/email-facture.js"></script>
    <script src="js/modules/immobilisations.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
